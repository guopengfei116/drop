# 第三方组件

## react-navigation

官方推荐使用的导航插件，可实现简单的页面切换效果，也可以实现复杂的页面路由。
react-navigation提供了好几种不同的导航组件，主要分为3类：stackNavigator、tabNavigator、DrawerNavigator，每个组件都有对应的工厂函数来创建，工厂函数的参数都需要两个，第一个参数都为路由配置对象，第二个参数针对组件传递不同的配置对象。

- [官网]<https://reactnavigation.org/>
- [github]<https://github.com/react-navigation/react-navigation>

### tab导航效果

先创建需要tab切换的几个页面组件，这里给出一个页面范例

```jsx
import React, { Component } from "react";
import { 
    StyleSheet, 
    View, 
    Text,
    Image
} from 'react-native';

export default class Home extends Component {
    // 可选的配置
    static navigationOptions = {
        // 设置标题栏
        headerTitle: '首页Title',
        // 设置label文本，会覆盖掉默认值
        tabBarLabel: "首页",
        // 设置icon，这里选中与不选中显示不同的
        tabBarIcon: ({focused}) => {
            if (focused) {
                return (
                    <Image style={styles.tabBarIcon} source={require('../public/img/12.jpg')}/>
                );
            } else {
                return (
                    <Image style={styles.tabBarIcon} source={require('../public/img/12.jpg')}/>
                );
            }
        }
    }

    render() {
        return (
            <View style={styles.container}>
                <Text>Home</Text>
            </View>
        );
    }
}

const styles = StyleSheet.create({
    container: {
        flex: 1,
        justifyContent: 'center',
        alignItems: 'center',
    },
    tabBarIcon: {
        width: 16,
        height: 16,
    }
});
```

再创建一个bottomTabNavigator容器，提供tabBarUI，并负责转载页面，控制页面的切换

```jsx
import React, { Component } from "react";
import { StyleSheet, View, Image } from 'react-native';
import { createBottomTabNavigator } from 'react-navigation';

import Home from './Home';
import MovieList from './MovieList';
import MovieDetail from './MovieDetail';

export default createBottomTabNavigator(

    // 配置tab页面，key值会作为label的默认值
    {
        Home,
        MovieList,
        MovieDetail, 
    },

    // 如果页面需要动态生成配置可以这样写，回调里返回一个动态构成的配置项
    // {
    //     Home: {
    //         screen: Home,
    //         navigationOptions: ({navigation, navigationOptions}) => {
    //             return { "tabBarLabel": "首页2" }
    //         }
    //     }
    // }

    // 配置tabBar样式与响应处理
    {
        tabBarOptions: {
            activeTintColor: 'aqua',
            inactiveTintColor: 'black',
            // 是否显示icon
            showIcon: true,
            // 设置tabBar样式
            style: {
                backgroundColor: 'purple',
                borderTopWidth: 1,
                borderTopColor: '#ccc',
                paddingVertical: 1,
                height: 40
            },
            // 设置label样式
            labelStyle: {
                fontSize: 12,
                marginTop: 1,
            }
        },
        swipeEnabled: true,
        animationEnabled: true,
        lazy: true,
        backBehavior: 'initialRoute'
    }
);
```

### 精致的tab导航效果

把createBottomTabNavigator改成createMaterialTopTabNavigator即可看到效果差异。
你可能会想，有没有marerialBottom呢？确实有，不过这是一个单独的插件，需要安装使用。

```shell
yarn install react-navigation-material-bottom-tabs
```

此API还要求安装react-native-vector-icons，如果正在使用Expo，可以开箱即用。<br />
[github]<https://github.com/oblador/react-native-vector-icons#installation>

```jsx

```

## react-native-swiper

一个轮播图组件

- [github](https://github.com/leecade/react-native-swiper)
- 安装: `yarn add react-native-swiper -S`

### 使用范例

需要注意，必须要给Swiper组件设置height属性，否则视图不会正常显示

```jsx
import React, { Component } from 'react';
import {
  StyleSheet,
  Text,
  View,
  Image
} from 'react-native';
import Swiper from 'react-native-swiper';

// showsButtons属性可用来控制左右箭头显示与隐藏, height设置高度, autoplay控制自动播放
export default class SwiperTest extends Component {
    render() {
        return (
            <Swiper style={styles.wrapper} showsButtons={true} height={160}>
                <View style={styles.slide1}>
                    <Text style={styles.text}>Hello Swiper</Text>
                </View>
                <View style={styles.slide2}>
                    <Text style={styles.text}>Beautiful</Text>
                </View>
                <View style={styles.slide3}>
                    <Text style={styles.text}>And simple</Text>
                </View>
            </Swiper>
        );
    }
}

var styles = StyleSheet.create({
    wrapper: {},
    slide1: {
        flex: 1,
        justifyContent: 'center',
        alignItems: 'center',
        backgroundColor: '#9DD6EB',
    },
    slide2: {
        flex: 1,
        justifyContent: 'center',
        alignItems: 'center',
        backgroundColor: '#97CAE5',
    },
    slide3: {
        flex: 1,
        justifyContent: 'center',
        alignItems: 'center',
        backgroundColor: '#92BBD9',
    },
    image:{
        width:'100%',
        height:'100%'
    }
});
```

### 测试

- 修改 `App.js` 根组件
- 导入`轮播图`组件并使用`测试`

```jsx
import SwiperTest from './components/SwiperTest';

export default class App extends Component {
    render() {
        return (
            <View style={styles.container}>
                <SwiperTest></SwiperTest>
                <Text>轮播图组件测试</Text>
            </View>
        );
    }
}
```

## react-native-image-picker

该组件可以调用摄像头进行拍照，因为RN默认没有提供摄像头API，所以使用该插件需要修改原生项目进行配置，同时修改原生项目后需要重新打包安装

- [github](https://github.com/marcshilling/react-native-image-picker)
- 安装 `npm install react-native-image-picker@latest`

### 原生配置

修改android/build.gradle文件

```gradle
buildscript {
    ...
    dependencies {
        classpath 'com.android.tools.build:gradle:2.2.+' // <- USE 2.2.+ version
    }
    ...
}
```

修改android/gradle/wrapper/gradle-wrapper.properties文件

```properties
distributionUrl=https\://services.gradle.org/distributions/gradle-2.14.1-all.zip
```

修改android/app/build.gradle

```gradle
dependencies {
  compile project(':react-native-image-picker')
}
```

修改AndroidManifest.xml

```xml
<uses-permission android:name="android.permission.CAMERA" />
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
```

修改MainApplication.java

```java
import com.imagepicker.ImagePickerPackage;

public class MainApplication extends Application implements ReactApplication {
    @Override
    protected List<ReactPackage> getPackages() {
        return Arrays.<ReactPackage>asList(
            new MainReactPackage(),
            new ImagePickerPackage(),
            // OR if you want to customize dialog style
            new ImagePickerPackage(R.style.my_dialog_style)
        );
    }
}
```

### 前端使用

```javascript
// 第1步：
import ImagePicker from 'react-native-image-picker'

//底部弹出框选项
var photoOptions = {
  title: '请选择',
  cancelButtonTitle: '取消',
  takePhotoButtonTitle: '拍照',
  chooseFromLibraryButtonTitle: '选择相册',
  quality: 0.75,
  allowsEditing: true,
  noData: false,
  storageOptions: {
    skipBackup: true,
    path: 'images'
  }
}

constructor(props) {
  super(props);
  this.state = {
    imgURL: ''
  }
}

<Button title="拍照" onPress={this.cameraAction}></Button>
<Image source={{uri: this.state.imgURL}} style={{width: 200, height: 200}}></Image>

cameraAction = () => {
  ImagePicker.showImagePicker(photoOptions, (response) => {
    console.log('response' + response);
    this.setState({
      imgURL: response.uri
    });
    if (response.didCancel) {
      return
    }
  })
}
```

### 打包

退出之前调试的App，重新运行`react-native run-android`进行打包部署，打包时会下载一些jar包，需要耐心等待。
