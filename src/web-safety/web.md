# Web安全

威胁安全的攻击方式与隐患

- 跨站脚本攻击XSS
- 跨站请求伪造攻击CSRF
- Cookies劫持
- 点击劫持攻击
- 传输过程数据劫持
- 密码安全
- SQL注入
- 信息泄露

## XSS

全称"Cross Site Scripting"，中文翻译为"跨站脚本攻击"，攻击方式是通过参数传入一段或多段script脚本，如果网站没有对传入的参数做校验或过滤，那么攻击脚本就会被运行。

只要攻击脚本正常执行，那么就可以做前端可做到的任何事情，比如获取页面数据（网站信息，用户资料），获取Cookies信息（登陆状态），拦截交互行为（改变网站交互逻辑），发送信息（传送窃取数据，或者做为肉鸡攻击别人）等等。

### 分类

- 反射型：url参数注入
- 存储型：先存储到数据库，读取时注入

### 注入点

- HTML节点内容

```html
<!-- content赋值为 => <script src="xxx.js"></script> -->
<div>
    ${ content }
</div>
```

- HTML属性

```html
<!-- img赋值为 => xxx.img" onload="alert(123) -->
<img src="${ img }" />
```

- JavaScript代码

```js
// data赋值为 => xxx"; alert(123); "
let str = "${ data }";
```

- 富文本或普通文本

```text
插入一段攻击脚本：<script src="xxx.js"></script>
```

### 典型攻击案例

queryString：假设网站某行为可通过URL进行传参，那么可以编写一个正常的网址，然后对某个URL参数做修改，拼接一段script标签，接下来就可以把这个网址发给别人进行钓鱼，一旦有人通过该网址打开网站，那么脚本就会在对方的机器上执行，从而窃取信息。

textEdit：假设某网站有编写文章或者评论功能，那么在文字当中夹杂一段script脚本并提交，接下来就等待有人打开这篇文章或评论信息，从而激活脚本，执行攻击行为。

registerInfo：假设某网站有用户信息注册功能，那么在注册的某个关键信息中夹杂一段script脚本，当公司工作人员通过内部的后台管理系统查阅注册信息时，攻击脚本就会被激活，从而获取公司内部信息与数据。

### 预防措施

- 通过响应头启动浏览器的默认预防机制，不过它只能防御html内容或属性替换造成的攻击，对于存储型的XSS无法预防。

```js
rep.set("X-XSS-Protection", 0)
```
